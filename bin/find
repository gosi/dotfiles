#!/bin/bash

function check() {
    filename=${1##*/}
    if
        [[
        ($filename == $pattern) &&
            ((-b $1) && ($filetype == "b") ||
            (-c $1) && ($filetype == "c") ||
            (-d $1) && ($filetype == "d") ||
            (-p $1) && ($filetype == "p") ||
            (-f $1) && ($filetype == "f") ||
            (-L $1) && ($filetype == "l") ||
            (-S $1) && ($filetype == "s") ||
            (-a $1) && ($filetype == ""))]]
                then
                    echo $1
    fi
}

function dirwalk() {
    check $1
    for file in $1/*
    do
        if [[ -a $file ]]
        then
            dirwalk $file
        fi
    done
}

path=$1
pattern="*"
filetype=""

if [[ -z $1 ]]
then
    path="."
fi

shift
while [[ $# -gt 0 ]]
do
    case $1 in
        "-type")
            filetype=$2 ;;
        "-iname")
            pattern=$2  ;;
    esac
    shift 2
done

dirwalk $path

exit
